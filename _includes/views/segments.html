{%- if include.keys -%}
  {%- assign keys = include.keys -%}
{%- endif -%}

{%- if include.field -%}
  {%- assign field = include.field -%}
{%- endif -%}

{%- assign posts = site.posts -%}
{%- if include.collection -%}
  {%- assign posts = include.collection -%}
{%- endif -%}

<div class="page-segments">
  <ul class="page-segments-list">
    {% for key in keys %}
      {% assign items = posts | where: field, key %}
      {% if include.exclude_meetings and items[0] and items[0].categories contains 'Meetings' %}
        {% continue %}
      {% endif %}
      {% if items.size > 0 %}
      <h2 id="{{ key }}" class="segment-name">{{ key }}</h2>
        {% for item in items %}
          {% if item != nil %}
            {%- assign post_item_class = "" -%}
            {%- if item.top -%}
              {%- assign post_item_class = "top-post" -%}
            {%- endif -%}
            <li class="{{ post_item_class }}">
              {%- include views/post-item.html -%}
            </li>
          {% endif %}
        {% endfor %}
      {% endif %}
    {% endfor %}
  </ul>
</div>
